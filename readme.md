These code are from the JavaCore book